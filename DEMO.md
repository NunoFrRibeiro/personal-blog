# Dagger demo workflow

## Build my personal blog live

### Backend 

At the root of the project, it's a simple Web server that listens on port 8080 and parses posts written in Markdown to generate date fed to the templates. 

### Frontend

Static blog with go templates to glue html pages together and include variable data generated by the backend in blocks of:

`{{ // generated code }}`

Located at `./templates`

### Posts

Markdown files to be be parsed and passed to the *Frontend* as code.

Located at `./posts/`

## CI

Located at `./ci`

### Test

Run the unit Tests for the project

`dagger call test --dir "."`

### Build

Build the Project

`dagger call build --dir "." --env dev`

### Serve

Run and serve the project locally

Web server deployed on `localhost:8080`

`dagger call serve --dir "." up`

Open `localhost:8080` in a browser.

### Deploy

Deploy the Blog to Netlify

`dagger call deploy --dir "." --netlify-token $NETLIFY_TOKEN`

## DEMO

- Start in code:
    - Show a pipeline written in the Go SDK 
    - Merging multiple modules in `./ci`. This ci uses:
        - golang module in `ci/backend/main.go`
        - proxy module in `ci/main.go` <- written in python!
        - netlify module in `ci/main.go` <- written in python!
        - github releases in `ci/main.go`

- Local runs
    - `dagger functions -m ci/backend`
    - `dagger functions`
    - `dagger call lint --help`
    - `dagger call lint --dir="."`
    - `dagger call serve -p 8080 --dir "."`
    - navigate to [localhost:8081](http://localhost:8081/) in browser
    - show built blog

- Show [Daggerverse](https://daggerverse.dev)
	- browse to Kyle Penfound [golang](https://daggerverse.dev/mod/github.com/kpenfound/dagger-modules/golang@44564d6443a919a2c3f1dd7ad02fc22b5fb9db8c) module
	- run module against the project: `dagger -m "github.com/kpenfound/dagger-modules/golang@v0.1.10" call build --source "."`

- CI
    - show `.circleci/config.yml`
    - create a Markdown post
	- push a commit
	- see run in CircleCI

- Dagger Cloud
	- look at all runs
	- look at a run
	- errors
	- caching
    - traces
